# Nanopore read granulation
<p>
&emsp; The purpose of these scripts is to take list of reads generated by nanopore sequencing, align them to one or more given reference sequences, and return three datasets:
</p>
<p>
<b>1) genome_df.csv</b>: A csv file with each row corresponding to the nucleotide position of the reference sequence. In addition to simple coverage, errors such as mismatches, deletions, and insertions are tracked. Furthermore the identity of the mismatches and insertions are recorded for potential SNP calling.
</p>
<p>
<b>2) read_df.csv</b>: A csv file in which each row corresponds to a BLAST HSPS to a given reference. This file records the start and end positions of the alignment to both the read and the reference, as well as the general error rates within the HSPS.
</p>
<p>
<b>3) deletions_df.csv</b>: A csv file containing the read, position, and identities of larger deletions (> 7 bases).
</p>

## Use
<p>
To use, simply place your reference sequence files in the `references` directory and run `bash bin/run_granulate.sh PATH/TO/READS.fasta`. The reference file name and header should be simple to prevent errors (example: '>TCV' instead of '>Turnip Crinkle Virus, isolate 161321'). The script first runs an alignment against all given references to separate reads based on alignment into newly generated directories. Reads that align to multiple references are assigned to the reference they align to better. Reads that are equally aligned to multiple references are assigned to all aligning references, as well as placed into a `multiple` directory that is not analyzed but can be referenced later.
</p>
<p>
After separating the reads based on alignment references, reads are again aligned to their respective reference and a JSON file is generated. The JSON is then paresed to generate the output datasets. From there, scripts within the `granulate_analysis.R` file can be used to generate a variety of helpful data visualization images.
</p>
<p>Scripts can be run independently of the bash script as many of the scripts have additional arugments beyond the defaults used in the bash script. Please see the documentation in those specific scripts for their use.</p>